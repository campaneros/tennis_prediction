============================================================
Training BDT per Tennis Match Prediction - MALE
============================================================
Caricamento dati preprocessati da: data/tennis_features_preprocessed_male.csv

Dati preprocessati caricati (male):
  Totale punti: 675670
  Features: 47
  P1 vince: 337835 (50.0%)
  P2 vince: 337835 (50.0%)

============================================================
Training del modello BDT
============================================================

Calcolo sample weights per punti critici...
  Match points: 2581 (peso 50x)
  Set points decisivi: 0 (peso 15x)
  Set points normali: 6773 (peso 7x)
  Punti normali: 532932 (peso 1x)
  Peso totale: 709393 (equivalente a 1.31x dataset)

Split dei dati:
  Training set: 542286 punti da 2358 match
  Test set: 133384 punti da 590 match

Allenamento del modello con sample weights...
      Iter       Train Loss      OOB Improve   Remaining Time 
         1           1.3643           0.0217            3.40m
         2           1.3433           0.0200            3.36m
         3           1.3239           0.0195            3.27m
         4           1.3057           0.0196            3.18m
         5           1.2879           0.0170            3.20m
         6           1.2708           0.0141            3.14m
         7           1.2561           0.0192            3.13m
         8           1.2406           0.0132            3.14m
         9           1.2266           0.0149            3.14m
        10           1.2128           0.0122            3.12m
        20           1.1110           0.0155            2.99m
        30           1.0450           0.0114            2.86m
        40           0.9999          -0.0084            2.75m
        50           0.9728           0.0129            2.66m
        60           0.9510          -0.0070            2.55m
        70           0.9374          -0.0167            2.44m
        80           0.9295           0.0089            2.33m
        90           0.9213           0.0053            2.22m
       100           0.9188           0.0088            2.11m
       200           0.8981           0.0168            1.08m
       300           0.8951           0.0218            0.00s

============================================================
Valutazione del modello
============================================================

Training Set:
  Accuracy: 0.7036
  AUC: 0.7957
  Log Loss: 0.5332

Test Set:
  Accuracy: 0.7042
  AUC: 0.7989
  Log Loss: 0.5315

============================================================
Feature Importance (Top 15)
============================================================
 1. p1_must_win_set          : 0.2777
 2. game_diff                : 0.2622
 3. p2_must_win_set          : 0.2348
 4. match_situation_score    : 0.0501
 5. set_number               : 0.0278
 6. p2_can_win_match_this_set: 0.0274
 7. match_criticality_score  : 0.0199
 8. point_diff               : 0.0180
 9. advantage_diff           : 0.0121
10. p1_can_win_match_this_set: 0.0116
11. p1_has_match_point_advantage: 0.0057
12. p2_advantage_score       : 0.0055
13. lstm_momentum_raw        : 0.0042
14. p1_games                 : 0.0040
15. lstm_momentum_centered   : 0.0040

Modello salvato in: models/tennis_bdt_male.pkl

============================================================
Training completato!
============================================================
