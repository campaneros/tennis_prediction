/Users/mcampana/Documents/Tesi_Mik/tennis_prediction/scripts/data_loader.py:26: DtypeWarning: Columns (14) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(path)
[train] Gender filter: male
[train] Filtered 75181 points:
[train]   - Excluded women's matches (>=2000): 73915
[train]   - Match 1701 (test set): 1266
[train] Training on 142840 points from men's matches (best-of-5)
[build_dataset] Set proximity weights - 1 set: 70627, 2 sets: 52394, 3+ sets: 19814
[train] dataset shape: (142208, 31) positives (P1 wins): 69627
[train] long_window=20, short_window=5, alpha=0.35
[train] weight exponent: 0.5
[train] sample weights - mean: 3.00, max: 10.58
[train] Test accuracy: 0.806
[train] Test ROC AUC:  0.904
[train] Model saved to: models/xgb_with_weighted_leverage.json
