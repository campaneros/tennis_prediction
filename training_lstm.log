nohup: input ignorato
============================================================
Training BDT per Tennis Match Prediction - MALE
============================================================
Caricamento e processamento dati da zero (genere: male)...

Caricamento probabilità LSTM da: data/lstm_point_probs_male.csv
  Caricate 145285 probabilità LSTM
Trovati 13 file di punti
Processando 2011-wimbledon-points.csv...
Processando 2012-wimbledon-points.csv...
Processando 2013-wimbledon-points.csv...
Processando 2014-wimbledon-points.csv...
Processando 2015-wimbledon-points.csv...
Processando 2016-wimbledon-points.csv...
Processando 2017-wimbledon-points.csv...
Processando 2018-wimbledon-points.csv...
Processando 2019-wimbledon-points.csv...
Processando 2021-wimbledon-points.csv...
Processando 2022-wimbledon-points.csv...
Processando 2023-wimbledon-points.csv...
Processando 2024-wimbledon-points.csv...

Dati preparati (male):
  Totale punti: 675670
  Features: 47
  P1 vince: 337835 (50.0%)
  P2 vince: 337835 (50.0%)

Controllo e pulizia NaN...
  Trovati 54 valori NaN, sostituisco con 0

Salvataggio dati preprocessati in: data/tennis_features_preprocessed_male.csv
Dati preprocessati salvati con successo!

============================================================
Training del modello BDT
============================================================

Calcolo sample weights per punti critici...
  Match points: 2581 (peso 50x)
  Set points decisivi: 0 (peso 15x)
  Set points normali: 6773 (peso 7x)
  Punti normali: 532932 (peso 1x)
  Peso totale: 709393 (equivalente a 1.31x dataset)

Split dei dati:
  Training set: 542286 punti da 2358 match
  Test set: 133384 punti da 590 match

Allenamento del modello con sample weights...
      Iter       Train Loss      OOB Improve   Remaining Time 
         1           1.3643           0.0217            3.51m
         2           1.3433           0.0200            3.44m
         3           1.3239           0.0195            3.33m
         4           1.3057           0.0196            3.25m
         5           1.2879           0.0170            3.23m
         6           1.2708           0.0141            3.18m
         7           1.2561           0.0192            3.17m
         8           1.2406           0.0132            3.17m
         9           1.2266           0.0149            3.17m
        10           1.2128           0.0122            3.15m
        20           1.1110           0.0156            3.02m
        30           1.0453           0.0113            2.90m
        40           1.0000          -0.0084            2.80m
        50           0.9730           0.0129            2.68m
        60           0.9509          -0.0070            2.57m
        70           0.9370          -0.0165            2.45m
        80           0.9294           0.0084            2.34m
        90           0.9213           0.0054            2.22m
       100           0.9189           0.0095            2.12m
       200           0.8980           0.0168            1.09m
       300           0.8951           0.0218            0.00s

============================================================
Valutazione del modello
============================================================

Training Set:
  Accuracy: 0.7037
  AUC: 0.7958
  Log Loss: 0.5332

Test Set:
  Accuracy: 0.7043
  AUC: 0.7991
  Log Loss: 0.5315

============================================================
Feature Importance (Top 15)
============================================================
 1. p1_must_win_set          : 0.2737
 2. game_diff                : 0.2629
 3. p2_must_win_set          : 0.2298
 4. match_situation_score    : 0.0547
 5. p2_can_win_match_this_set: 0.0301
 6. set_number               : 0.0274
 7. match_criticality_score  : 0.0227
 8. point_diff               : 0.0174
 9. advantage_diff           : 0.0124
10. p1_can_win_match_this_set: 0.0085
11. p1_has_match_point_advantage: 0.0057
12. p2_advantage_score       : 0.0051
13. match_on_the_line        : 0.0047
14. lstm_point_prob          : 0.0041
15. lstm_momentum_centered   : 0.0040

Modello salvato in: models/tennis_bdt_male.pkl

============================================================
Training completato!
============================================================
